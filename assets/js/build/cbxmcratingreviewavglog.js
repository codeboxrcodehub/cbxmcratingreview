import{_ as B,S as F,r as x,o as u,c as U,w as g,a as t,t as a,e as c,v as A,f,x as I,F as N,b as v,g as T,j as _,d as p,A as M,B as P,C as V,D,E,H,I as W,G as z}from"./vue-router.js";import{W as Q,T as j,d as J,v as O,Q as G}from"./cbxmcratingreview-head.js";import{C as K}from"./component.js";const X={name:"Log Average",components:{WpHead:Q,TableLite:j,flatPickr:K},async mounted(){this.$route.query.order_by&&this.$route.query.sort&&(this.table.sortable.order=this.$route.query.order_by,this.table.sortable.sort=this.$route.query.sort,this.order_by(this.$route.query.order_by,this.$route.query.sort)),this.$route.query.page&&await this.pagination(this.$route.query.page);let i=[],s=await localStorage.getItem("cbxmcratingreview_avg_log_list");s&&(s=JSON.parse(s),Array.isArray(s)&&s.length&&(i=s)),Array.isArray(i)&&i.length===0&&(i=["id","form","post","average","total","date_modified","date_created","action"]),this.table_col_show=i,this.table.columns=await this.set_table_columns(),await this.doSearch(0,this.limit,this.table.sortable.order,this.table.sortable.sort)},watch:{table_col_show:{deep:!0,handler(i){localStorage.setItem("cbxmcratingreview_avg_log_list",JSON.stringify(i)),this.table.columns=this.set_table_columns()}}},data(){return{cbxmcratingreview_vue_var,cbx_table_lite:cbxmcratingreview_vue_var.cbx_table_lite,logs:[],table_col_show:[],dataLoading:!1,table:{isLoading:!1,columns:[],rows:[],sortable:{order:"id",sort:"desc"}},filterForm:"",selectedRows:[],total_count:0,dateFilter:null,flatPickerConf:{mode:"range",dateFormat:"Y-m-d"},review_statuses:cbxmcratingreview_vue_var.review_statuses,translations:cbxmcratingreview_vue_var.translations}},methods:{clearFilter(){this.searchText="",this.filterForm="",this.search()},search(){let i=new URLSearchParams(this.queryStr);this.searchText?i.set("search",this.searchText):i.delete("search"),this.filterForm?i.set("form",this.filterForm):i.delete("form"),this.dateFilter?i.set("date",this.dateFilter):i.delete("date"),this.queryStr=i.toString(),this.doSearch(0,this.limit,this.table.sortable.order,this.table.sortable.sort)},set_table_columns(){let i=this.table_col_show;return[{label:cbxmcratingreview_vue_var.translations.id,field:"id",sortable:!0,isKey:!0,is_show:i.includes("id")},{label:cbxmcratingreview_vue_var.translations.form,field:"form.name",sortable:!1,is_show:i.includes("form")},{label:cbxmcratingreview_vue_var.translations.post,field:"post",sortable:!1,is_show:i.includes("post")},{label:cbxmcratingreview_vue_var.translations.article,field:"article",sortable:!1,is_show:i.includes("article")},{label:cbxmcratingreview_vue_var.translations.average,field:"avg_rating",sortable:!1,is_show:i.includes("average")},{label:cbxmcratingreview_vue_var.translations.total,field:"total_count",sortable:!1,is_show:i.includes("total")},{label:cbxmcratingreview_vue_var.translations.created,field:"formatted_create_date",sortable:!1,is_show:i.includes("date_created")},{label:cbxmcratingreview_vue_var.translations.modified,field:"formatted_update_date",sortable:!1,is_show:i.includes("date_modified")},{label:cbxmcratingreview_vue_var.translations.action,field:"action",sortable:!1,is_show:i.includes("action")}]},async doSearch(i,s,n,d,e=1){this.table.isLoading=!0,this.limit=s,this.dataLoading=!0,this.table.sortable.order=n,this.table.sortable.sort=d,await this.pagination(e),await this.order_by(this.table.sortable.order,this.table.sortable.sort),this.$router.push("/?"+this.queryStr),await this.axios.get(this.cbxmcratingreview_vue_var.rest_end_points.get_avg_log_list+"?"+this.queryStr).then(l=>{var r,h,w,m,o,b,y,k,S,C,q,L,R;(r=l==null?void 0:l.data)!=null&&r.success?(this.total_count=(w=(h=l==null?void 0:l.data)==null?void 0:h.data)==null?void 0:w.total,this.table.rows=(o=(m=l==null?void 0:l.data)==null?void 0:m.data)==null?void 0:o.data,this.logs=(y=(b=l==null?void 0:l.data)==null?void 0:b.data)==null?void 0:y.data,(S=(k=l==null?void 0:l.data)==null?void 0:k.data)==null||delete S.data,this.paginationInfo=(C=l==null?void 0:l.data)==null?void 0:C.data,this.table.totalRecordCount=(q=this.paginationInfo)==null?void 0:q.total):((L=l==null?void 0:l.data)!=null&&L.info&&this.errorMessage((R=l==null?void 0:l.data)==null?void 0:R.info),this.paginationInfo={},this.table.rows=[]),this.table.isLoading=!1,this.dataLoading=!1})},pagination(i){let s=new URLSearchParams(this.queryStr);i?s.set("page",i):s.delete("page"),this.limit?s.set("limit",this.limit):s.delete("limit"),this.queryStr=s.toString()},async order_by(i,s){let n=new URLSearchParams(this.queryStr);this.queryStr=n.toString(),i?n.set("order_by",i):n.delete("order_by"),s?n.set("sort",s):n.delete("sort"),this.queryStr=n.toString()},checkedRows(i){this.selectedRows=i.map(s=>Number(s))},deleteLog(i){F.fire({title:this.cbxmcratingreview_vue_var.translations.delete_confirmation_title,text:this.cbxmcratingreview_vue_var.translations.delete_confirmation_txt,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",customClass:{container:"swal2-container-cbx"},confirmButtonText:this.cbxmcratingreview_vue_var.translations.delete_btn_txt}).then(s=>{s.isConfirmed&&this.axios.post(this.cbxmcratingreview_vue_var.rest_end_points.delete_avg_log,{id:i}).then(n=>{var d,e,l;if((d=n==null?void 0:n.data)!=null&&d.success){this.successToast((e=n==null?void 0:n.data)==null?void 0:e.info),this.selectedRows=[];const r=document.querySelectorAll(".vtl-tbody-checkbox");typeof r<"u"&&r&&r.forEach(h=>{h.checked=!1}),document.querySelector(".vtl-thead-checkbox").checked=!1,this.doSearch(0,this.limit,this.table.sortable.order,this.table.sortable.sort)}else this.errorMessage((l=n==null?void 0:n.data)==null?void 0:l.error)})})},deleteSelectedItems(){F.fire({title:cbxmcratingreview_vue_var.translations.delete_confirmation_title,text:cbxmcratingreview_vue_var.translations.delete_confirmation_txt,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:cbxmcratingreview_vue_var.translations.delete_btn_txt,customClass:{container:"swal2-container-cbx"}}).then(i=>{i.isConfirmed&&this.axios.post(cbxmcratingreview_vue_var.rest_end_points.delete_avg_log+"?id="+this.selectedRows.join(",")).then(s=>{var n,d,e;if((n=s==null?void 0:s.data)!=null&&n.success){this.successMessage((d=s==null?void 0:s.data)==null?void 0:d.info),this.selectedRows=[];const l=document.querySelectorAll(".vtl-tbody-checkbox");typeof l<"u"&&l&&l.forEach(r=>{r.checked=!1}),document.querySelector(".vtl-thead-checkbox").checked=!1,this.doSearch(0,this.limit,this.table.sortable.order,this.table.sortable.sort)}else this.errorMessage((e=s==null?void 0:s.data)==null?void 0:e.error)}).catch(s=>{this.errorMessage(s)})})}}},Y={class:"inside"},Z={class:"container"},$={class:"row"},tt={class:"col-12"},et={class:"cbx-sub-heading-wrap",id:"dashlisting_toolbar"},st={class:"cbx-sub-heading-l"},ot={class:"cbx-sub-heading cbx-sub-heading-log cbx-sub-heading-logs"},it={class:"cbx-listing-table-filters-wrap cbx-listing-table-filters-wrap-log cbx-listing-table-filters-wrap-logs"},lt={class:"container"},at={class:"row"},nt={class:"col-12"},rt={class:"cbx-listing-table-filters"},ct={class:"cbx-listing-table-filter"},_t={value:""},dt=["value"],bt={class:"cbx-listing-table-prebox-wrap cbx-listing-table-prebox-wrap-form cbx-listing-table-prebox-wrap-loglist"},ht={class:"container"},ut={class:"row"},vt={class:"col col-12"},mt={class:"cbx-listing-table-prebox-l pull-left"},gt=["title"],ft={class:"cbx-icon"},wt={class:"button-label"},xt={class:"sr-only"},pt={class:"cbx-listing-table-prebox-r pull-right"},yt=["title"],kt={key:0,class:"cbx-icon"},St={key:1,class:"cbx-icon cbx-icon-refresh-white"},Ct={class:"sr-only"},qt=["title"],Lt={class:"cbx-icon"},Rt={class:"sr-only"},Ft={class:"dropdown dropdown-menu ml-10"},Vt=["title","aria-label"],Bt={class:"cbx-icon"},Ut={class:"sr-only"},At={class:"card card-menu card-menu-right"},It={class:"checkbox_field"},Nt={for:"id"},Tt={class:"mt-5"},Mt={class:"checkbox_field"},Pt={for:"form"},Dt={class:"mt-5"},Et={class:"checkbox_field"},Ht={for:"post"},Wt={class:"mt-5"},zt={class:"checkbox_field"},Qt={for:"article"},jt={class:"mt-5"},Jt={class:"checkbox_field"},Ot={for:"average"},Gt={class:"mt-5"},Kt={class:"checkbox_field"},Xt={for:"total"},Yt={class:"mt-5"},Zt={class:"checkbox_field"},$t={for:"date_created"},te={class:"mt-5"},ee={class:"checkbox_field"},se={for:"date_modified"},oe={class:"mt-5"},ie={class:"checkbox_field"},le={for:"action"},ae={class:"container"},ne=["href"],re=["href"],ce=["href"],_e={class:"button_actions"},de=["onClick","title"],be={class:"cbx-icon"},he={class:"sr-only"};function ue(i,s,n,d,e,l){const r=x("inline-svg"),h=x("table-lite"),w=x("wp-head");return u(),U(w,{heading:e.translations.avg_log_manager,"class-name":"cbxmcratingreview-page-log cbxmcratingreview-page-listing"},{default:g(()=>{var m;return[t("div",Y,[t("div",Z,[t("div",$,[t("div",tt,[t("div",et,[t("div",st,[t("h2",ot,a(e.translations.avg_logs),1)]),s[14]||(s[14]=t("div",{class:"cbx-sub-heading-r"},null,-1))])])])]),t("div",it,[t("div",lt,[t("div",at,[t("div",nt,[t("div",rt,[t("div",ct,[c(t("select",{"onUpdate:modelValue":s[0]||(s[0]=o=>e.filterForm=o),class:"form-control"},[t("option",_t,a((m=e.cbxmcratingreview_vue_var.translations)==null?void 0:m.select_form),1),(u(!0),f(N,null,I(e.cbxmcratingreview_vue_var.form_list,(o,b)=>(u(),f("option",{value:b},a(o),9,dt))),256))],512),[[A,e.filterForm]])])])])])])]),t("div",bt,[t("div",ht,[t("div",ut,[t("div",vt,[t("div",mt,[t("h3",null,a(e.translations.total)+": "+a(e.total_count),1),e.selectedRows.length>0?(u(),f("button",{key:0,role:"button",class:"button error icon icon-inline ml-10",onClick:s[1]||(s[1]=o=>l.deleteLog(e.selectedRows)),title:e.translations.delete_all},[t("i",ft,[v(r,{src:e.cbxmcratingreview_vue_var.icons_url+"icon_delete.svg"},null,8,["src"])]),t("span",wt,a(e.translations.delete_all)+" ("+a(e.selectedRows.length)+")",1),t("span",xt,a(e.translations.buttons.delete.sr_label),1)],8,gt)):T("",!0)]),t("div",pt,[t("button",{role:"button",class:"button primary icon icon-only icon-inline",onClick:s[2]||(s[2]=(...o)=>l.search&&l.search(...o)),title:e.cbxmcratingreview_vue_var.translations.buttons.search.title},[e.dataLoading?(u(),f("i",St)):(u(),f("i",kt,[v(r,{src:e.cbxmcratingreview_vue_var.icons_url+"icon_search.svg"},null,8,["src"])])),t("span",Ct,a(e.cbxmcratingreview_vue_var.translations.buttons.search.sr_label),1)],8,yt),t("button",{role:"button",class:"button secondary icon icon-only icon-inline",onClick:s[3]||(s[3]=(...o)=>l.clearFilter&&l.clearFilter(...o)),title:e.cbxmcratingreview_vue_var.translations.buttons.reset.title},[t("i",Lt,[v(r,{src:e.cbxmcratingreview_vue_var.icons_url+"icon_reset.svg"},null,8,["src"])]),t("span",Rt,a(e.cbxmcratingreview_vue_var.translations.buttons.reset.sr_label),1)],8,qt),t("details",Ft,[t("summary",{class:"button outline primary icon icon-only",title:e.translations.buttons.filter.title,"aria-label":e.translations.buttons.filter.title},[t("i",Bt,[v(r,{src:e.cbxmcratingreview_vue_var.icons_url+"icon_funnel.svg"},null,8,["src"])]),t("span",Ut,a(e.translations.buttons.filter.sr_label),1)],8,Vt),t("div",At,[t("ul",null,[t("li",null,[t("div",It,[c(t("input",{type:"checkbox",class:"magic-checkbox",id:"id",value:"id","onUpdate:modelValue":s[4]||(s[4]=o=>e.table_col_show=o)},null,512),[[_,e.table_col_show]]),t("label",Nt,a(e.translations.id),1)])]),t("li",Tt,[t("div",Mt,[c(t("input",{type:"checkbox",class:"magic-checkbox",id:"form","onUpdate:modelValue":s[5]||(s[5]=o=>e.table_col_show=o),value:"form"},null,512),[[_,e.table_col_show]]),t("label",Pt,a(e.translations.form),1)])]),t("li",Dt,[t("div",Et,[c(t("input",{type:"checkbox",class:"magic-checkbox",id:"post","onUpdate:modelValue":s[6]||(s[6]=o=>e.table_col_show=o),value:"post"},null,512),[[_,e.table_col_show]]),t("label",Ht,a(e.translations.post),1)])]),t("li",Wt,[t("div",zt,[c(t("input",{type:"checkbox",class:"magic-checkbox",id:"article","onUpdate:modelValue":s[7]||(s[7]=o=>e.table_col_show=o),value:"article"},null,512),[[_,e.table_col_show]]),t("label",Qt,a(e.translations.article),1)])]),t("li",jt,[t("div",Jt,[c(t("input",{type:"checkbox",class:"magic-checkbox",id:"average","onUpdate:modelValue":s[8]||(s[8]=o=>e.table_col_show=o),value:"average"},null,512),[[_,e.table_col_show]]),t("label",Ot,a(e.translations.average),1)])]),t("li",Gt,[t("div",Kt,[c(t("input",{type:"checkbox",class:"magic-checkbox",id:"total","onUpdate:modelValue":s[9]||(s[9]=o=>e.table_col_show=o),value:"total"},null,512),[[_,e.table_col_show]]),t("label",Xt,a(e.translations.total),1)])]),t("li",Yt,[t("div",Zt,[c(t("input",{type:"checkbox",class:"magic-checkbox",id:"date_created","onUpdate:modelValue":s[10]||(s[10]=o=>e.table_col_show=o),value:"date_created"},null,512),[[_,e.table_col_show]]),t("label",$t,a(e.translations.created),1)])]),t("li",te,[t("div",ee,[c(t("input",{type:"checkbox",class:"magic-checkbox",id:"date_modified","onUpdate:modelValue":s[11]||(s[11]=o=>e.table_col_show=o),value:"date_modified"},null,512),[[_,e.table_col_show]]),t("label",se,a(e.translations.modified),1)])]),t("li",oe,[t("div",ie,[c(t("input",{type:"checkbox",class:"magic-checkbox",id:"action","onUpdate:modelValue":s[12]||(s[12]=o=>e.table_col_show=o),value:"action",disabled:""},null,512),[[_,e.table_col_show]]),t("label",le,a(e.translations.action),1)])])])])])])])])])]),t("div",ae,[v(h,{translations:e.cbx_table_lite,messages:{pagingInfo:e.translations.showing+" {0}-{1} "+e.translations.of+" {2}",pageSizeChangeLabel:e.translations.rowCount,gotoPageLabel:"     "+e.translations.goTo,noDataAvailable:e.translations.no_log_found},class:"cbx-listing-table cbx-listing-table-form mt-0","is-slot-mode":!0,"is-loading":e.table.isLoading,columns:e.table.columns,rows:e.logs,total:e.table.totalRecordCount,sortable:e.table.sortable,"page-size":i.limit,"has-checkbox":!0,onDoSearch:l.doSearch,onIsFinished:s[13]||(s[13]=o=>e.table.isLoading=!1),onReturnCheckedRows:l.checkedRows},{article:g(o=>{var b;return[t("a",{href:o.value.permalink,target:"_blank"},a((b=o.value.post)==null?void 0:b.post_title),9,ne)]}),total_count:g(o=>[p(a(o.value.total_count)+" - ",1),t("a",{href:"/wp-admin/admin.php?page=cbxmcratingreviewreview-list#/?post_id="+o.value.post_id},a(e.translations.view_all),9,re)]),post:g(o=>[p(a(o.value.post_id)+" (",1),t("a",{href:o.value.editlink,target:"_blank"},a(e.translations.edit),9,ce),s[15]||(s[15]=p(") "))]),action:g(o=>[t("div",_e,[t("button",{role:"button",class:"button error icon icon-only icon-inline small",onClick:b=>l.deleteLog(o.value.id),title:e.translations.buttons.delete.title},[t("i",be,[v(r,{src:e.cbxmcratingreview_vue_var.icons_url+"icon_delete.svg"},null,8,["src"])]),t("span",he,a(e.translations.buttons.delete.sr_label),1)],8,de)])]),_:1},8,["translations","messages","is-loading","columns","rows","total","sortable","page-size","onDoSearch","onReturnCheckedRows"])])])]}),_:1},8,["heading"])}const ve=B(X,[["render",ue]]),me=M(),ge=P({history:me,routes:[{path:"/",component:ve}]});V.defaults.headers.common["X-WP-Nonce"]=cbxmcratingreview_vue_var.rest_nonce;const fe=D(z).use(J).use(O({key:"$vfm",componentName:"VueFinalModal",dynamicContainerName:"ModalsContainer"})).use(E,V).use(H).use(ge).component("inline-svg",W).component("QuillEditor",G);fe.mount("#cbxmcratingreview-avg-log-list");
